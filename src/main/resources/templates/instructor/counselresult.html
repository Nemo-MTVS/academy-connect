<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">

<head th:replace="fragments/layout :: head('NimoVerse - 전체 상담 내역')">
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
</head>

<body>
    <!-- 왼쪽 메뉴 -->
    <div th:replace="fragments/layout :: sidebar('counselresult')"></div>
    
    <!-- 모바일 Bottom Navigation -->
    <div th:replace="fragments/layout :: bottomnav('counselresult')"></div>
    
    <div class="content-wrapper">
        <div class="main-content">
            <h4 class="mb-4">전체 상담 내역</h4>

            <div class="tab-container">
                <ul class="nav nav-tabs" id="reservationTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="upcoming-tab" data-bs-toggle="tab" data-bs-target="#upcoming" type="button" role="tab" aria-controls="upcoming" aria-selected="true" th:classappend="${activeTab == 'upcoming' ? 'active' : ''}" th:href="@{/teacher/reservation?view=upcoming}">예정된 예약</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="past-tab" data-bs-toggle="tab" data-bs-target="#past" type="button" role="tab" aria-controls="past" aria-selected="false" th:classappend="${activeTab == 'past' ? 'active' : ''}" th:href="@{/teacher/reservation?view=past}">지난 예약</button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="request-tab" data-bs-toggle="tab" data-bs-target="#request" type="button" role="tab" aria-controls="request" aria-selected="false">예약 요청</button>
                    </li>
                </ul>
            </div>



            <div class="tab-content" id="reservationTabContent">
                <!-- 전체 상담 내역 조회 -->
                <div class="tab-pane fade"  th:classappend="${activeTab == 'upcoming'} ? ' show active' : ''" id="upcoming" role="tabpanel" aria-labelledby="upcoming-tab">
                    <div class="table-container">
                        <table class="reservation-table">
                            <thead>
                                <tr>
                                    <th>학생</th>
                                    <th>상담 일시</th>
                                    <th>상담 내용</th>
                                    <th>수정</th>
                                    <th>삭제</th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                            <tr  th:if="${counselingResults != null && !counselingResults.isEmpty()}" th:each="counselingResult : ${counselingResults}">
                                <td>
                                    <div class="student-info">
                                        <img th:src="${counselingResult.filePath}"  alt="프로필 사진" class="avatar">
                                        <div>
                                            <div th:text="${counselingResult.student.name}">이름</div>
                                            <div class="text-muted small" th:text="${counselingResult.student.classGroup}">전공</div>
                                        </div>
                                    </div>
                                </td>
                                <td th:text="${counselingResult.counselAt}"></td>
                                <td th:text="${counselingResult.md}"></td>
                                <td>
                                    <div >
                                        <form th:action="@{/teacher/consulting/{id}/cancel(id=${counselingResult.id})}" method="post"
                                              onsubmit="return confirm('상담 내역을 수정하시겠습니까?');">
                                            <button type="submit" class="action-btn danger" style="border: none;">수정</button>
                                        </form>
                                        <form th:action="@{/teacher/consulting/{id}/cancel(id=${counselingResult.id})}" method="post"
                                              onsubmit="return confirm('상담 내역을 삭제하시겠습니까?');">
                                            <button type="submit" class="action-btn danger" style="border: none;">삭제</button>
                                        </form>
                                    </div>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <th:block th:replace="fragments/layout :: scripts"></th:block>
</body>
</html> 